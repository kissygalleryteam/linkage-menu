KISSY.add('kg/linkage-menu/1.0.1/index',["node","base","menu"],function(S ,require, exports, module) {var e=require("node").all,t=require("base"),n=require("menu"),r=t.extend({initializer:function(){var e=this,t=e.get("$target"),r=e.get("data");if(!t.length||!r.length)return!1;var i=new n({render:t,prefixCls:e.get("prefixCls")});e.set("menu",i)},render:function(){var e=this,t=e.get("data"),n=e.get("menu");e._addItems(n,t),n.render(),e._menuShow(n),e._addLevelSign(n,1),n.on("click",function(t){var n=t.target,r=n.get("itemData");return r&&r.children?(e.selected(n),e.renderSub(n,r.children),void e.fire("click",{menu:n})):!1}),e.fire("render")},renderSub:function(e,t){var n=this,r=e.get("isRenderSubMenu"),i=e.get("menu");if(!r){i.set("autoHideOnMouseLeave",!1);var a=e.get("parent"),u=a.get("level");n._addLevelSign(i,u+1),n._addItems(i,t),e.set("isRenderSubMenu",!0)}return n._menuShow(i),i},renderItem:function(e,t){var r=this,i=r.get("itemFilter"),a=i.call(r,e,t),u=new n.SubMenu({content:a,prefixCls:r.get("prefixCls")});return u.set("itemData",e),u},_addItems:function(e,t){var n=this;return S.each(t,function(t){var r=n.renderItem(t,e);e.addChild(r)}),e},_addLevelSign:function(e,t){e.set("level",t);var n=e.$el;return n.addClass("lm-level-"+t),t},selected:function(e){var t=e.get("parent"),n=t.get("children");return S.each(n,function(e){e.set("selected",!1)}),e.set("selected",!0),e},_menuShow:function(e){var t=this,n=t.get("prefixCls");e.show(),e.$el.addClass(n+"show")}},{ATTRS:{$target:{value:"",getter:function(t){return e(t)}},data:{value:[]},itemFilter:{value:""},menu:{value:""},prefixCls:{value:"lm-"}}});module.exports=r;});